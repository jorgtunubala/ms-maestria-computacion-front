<div class="container">
  <div class="header">
    <h1>Evaluación docente</h1>
    <div class="docentes-evaluados">
      <p>Docentes evaluados {{ docentesEvaluados }} de {{ totalDocentes }}</p>
    </div>
  </div>

  <p-table [value]="docentes" class="docentes-table">
    <ng-template pTemplate="header">
      <tr>
        <th scope="col">Docente</th>
        <th scope="col">Asignatura</th>
        <th scope="col">Nota final</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-docente>
      <tr>
        <td>{{ docente.nombre }}</td>
        <td>{{ docente.asignatura }}</td>
        <td>{{ docente.notaFinal !== null ? docente.notaFinal : 'Sin evaluar' }}</td>
      </tr>
    </ng-template>
  </p-table>

  <div *ngFor="let docente of docentes; let i = index" class="evaluacion-container" [hidden]="i !== currentDocente">
    <h3 class="asignatura">Asignatura - {{ docente.asignatura }}</h3>
    <h4 class="docente-evaluar">Docente a evaluar - {{ docente.nombre }}</h4>

    <p-table [value]="preguntas" class="evaluacion-table">
      <ng-template pTemplate="header">
        <tr>
          <th scope="col">No</th>
          <th scope="col">Pregunta</th>
          <th *ngFor="let n of [1,2,3,4,5,6,7,8,9,10]" scope="col">Nota {{ n }}</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-pregunta let-j="rowIndex">
        <tr>
          <td>{{ j + 1 }}</td>
          <td>{{ pregunta }}</td>
          <td *ngFor="let n of [1,2,3,4,5,6,7,8,9,10]">
            <p-radioButton name="pregunta{{ i }}{{ j }}" [value]="n" [(ngModel)]="evaluaciones[i].respuestas[j]" (onClick)="evaluar(i, j, n)"></p-radioButton>
          </td>
        </tr>
      </ng-template>
    </p-table>

    <div class="buttons">
      <button pButton type="button" label="Anterior" (click)="anterior()" [disabled]="currentDocente === 0"></button>
      <button pButton *ngIf="currentDocente < docentes.length - 1" type="button" label="Siguiente" (click)="siguiente()"></button>
      <button pButton *ngIf="currentDocente === docentes.length - 1" type="button" label="Finalizar evaluación" (click)="finalizarEvaluacion()" [disabled]="!canFinalizar()"></button>
    </div>
  </div>

  <div class="finalizar-container" *ngIf="evaluationCompleted">
    <p>Evaluación completada. Todas las notas finales han sido calculadas.</p>
  </div>
</div>
